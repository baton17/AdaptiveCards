<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>Adaptive Cards Example</title>

	<script src="https://unpkg.com/markdown-it@8.4.0/dist/markdown-it.js"></script>

	<style type="text/css">
		#exampleDiv {
			width: 250px;
			border: solid 1px black;
		}
		textarea {
			margin-top: 10px;
			margin-left: 50px;
			width: 500px;
			height: 700px;
			-moz-border-bottom-colors: none;
			-moz-border-left-colors: none;
			-moz-border-right-colors: none;
			-moz-border-top-colors: none;
			background: none repeat scroll 0 0 rgba(0, 0, 0, 0.07);
			border-color: -moz-use-text-color #FFFFFF #FFFFFF -moz-use-text-color;
			border-image: none;
			border-radius: 6px 6px 6px 6px;
			border-style: none solid solid none;
			border-width: medium 1px 1px medium;
			box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12) inset;
			color: #555555;
			font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
			font-size: 1em;
			line-height: 1.4em;
			padding: 5px 8px;
			transition: background-color 0.2s ease 0s;
		}


		textarea:focus {
			background: none repeat scroll 0 0 #FFFFFF;
			outline-width: 0;
		}

		.button {
			background-color: #4CAF50;
			border: none;
			color: white;
			padding: 15px 32px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 16px;
			margin: 4px 2px;
			cursor: pointer;
		}
	</style>

	<script type="text/javascript">
		var cardText = {"type":"AdaptiveCard","version":"1.5","body":[{"type":"TextBlock","text":"**Inline Editable Cards!**"},{"type":"Input.Text","id":"inputTextId","value":"$20000","label":"Est. Amount"},{"type":"Input.Text","id":"inputTextId2","value":"$20000","label":"Est. Amount","labelAlignment":"horizontal"},{"type":"Input.Text","id":"inputTextId3","value":"$20000","label":"Est. Amount","inputStyle":"readWrite"},{"type":"Input.Text","id":"inputTextId4","value":"$20000","label":"Est. Amount","inputStyle":"readWrite","labelAlignment":"horizontal"}],"actions":[{"type":"Action.Submit","title":"Save","associatedInputs":"auto","disabledUnlessAssociatedInputsChange":true},{"type":"Action.OpenUrl","title":"Learn More","url":"https://github.com/Microsoft/AdaptiveCards"}]};

		var cardDate = {"type":"AdaptiveCard","version":"1.5","body":[{"type":"TextBlock","text":"**Inline Editable Cards!**"},{"type":"Input.Date","id":"inputTextId","value":"2017-10-12","label":"Est. Date"},{"type":"Input.Date","id":"inputTextId2","value":"2017-10-12","label":"Est. Date","labelAlignment":"horizontal"},{"type":"Input.Date","id":"inputTextId3","value":"2017-10-12","label":"Est. Date","inputStyle":"readWrite"},{"type":"Input.Date","id":"inputTextId4","value":"2017-10-12","label":"Est. Date","inputStyle":"readWrite","labelAlignment":"horizontal"}],"actions":[{"type":"Action.Submit","title":"Save","associatedInputs":"auto","disabledUnlessAssociatedInputsChange":true},{"type":"Action.OpenUrl","title":"Learn More","url":"https://github.com/Microsoft/AdaptiveCards"}]};

		var cardTime = {"type":"AdaptiveCard","version":"1.5","body":[{"type":"TextBlock","text":"**Inline Editable Cards!**"},{"type":"Input.Time","id":"inputTextId","value":"15:30","label":"Est. Time"},{"type":"Input.Time","id":"inputTextId2","value":"15:30","label":"Est. Date","labelAlignment":"horizontal"},{"type":"Input.Time","id":"inputTextId3","value":"15:30","label":"Est. Time","inputStyle":"readWrite"},{"type":"Input.Time","id":"inputTextId4","value":"15:30","label":"Est. Time","inputStyle":"readWrite","labelAlignment":"horizontal"}],"actions":[{"type":"Action.Submit","title":"Save","associatedInputs":"auto","disabledUnlessAssociatedInputsChange":true},{"type":"Action.OpenUrl","title":"Learn More","url":"https://github.com/Microsoft/AdaptiveCards"}]};
	
		var cardChoiceSet = {"type":"AdaptiveCard","version":"1.5","body":[{"type":"TextBlock","text":"**Inline Editable Cards!**"},{"type":"Input.ChoiceSet","id":"myColor","style":"compact","label":"select","isMultiSelect":false,"value":"1","choices":[{"title":"Red","value":"1"},{"title":"Green","value":"2"},{"title":"Blue","value":"3"}]},{"type":"Input.ChoiceSet","id":"myColor","style":"compact","labelAlignment":"horizontal","label":"select","isMultiSelect":false,"value":"1","choices":[{"title":"Red","value":"1"},{"title":"Green","value":"2"},{"title":"Blue","value":"3"}]},{"type":"Input.ChoiceSet","id":"myColor","style":"compact","label":"select","isMultiSelect":false,"inputStyle":"readWrite","value":"1","choices":[{"title":"Red","value":"1"},{"title":"Green","value":"2"},{"title":"Blue","value":"3"}]},{"type":"Input.ChoiceSet","id":"myColor","style":"compact","label":"select","isMultiSelect":false,"inputStyle":"readWrite","labelAlignment":"horizontal","value":"1","choices":[{"title":"Red","value":"1"},{"title":"Green","value":"2"},{"title":"Blue","value":"3"}]}],"actions":[{"type":"Action.Submit","title":"Save","associatedInputs":"auto","disabledUnlessAssociatedInputsChange":true},{"type":"Action.OpenUrl","title":"Learn More","url":"https://github.com/Microsoft/AdaptiveCards"}]};


			function renderCard(card) {

			// author a card
			// in practice you'll probably get this from a service
			// see http://adaptivecards.io/samples/ for inspiration
			// Create an AdaptiveCard instance
			var adaptiveCard = new AdaptiveCards.AdaptiveCard();

			// Set its hostConfig property unless you want to use the default Host Config
			// Host Config defines the style and behavior of a card
			adaptiveCard.hostConfig = new AdaptiveCards.HostConfig({
				fontFamily: "Segoe UI, Helvetica Neue, sans-serif"
				// More host config options
				// You can find example configs here: https://github.com/microsoft/AdaptiveCards/tree/main/samples/HostConfig
			});

			// Set the adaptive card's event handlers. onExecuteAction is invoked
			// whenever an action is clicked in the card
			adaptiveCard.onExecuteAction = function (action) {
				alert("Records Saved");
			}

			// Parse the card payload
			adaptiveCard.parse(card);

			// Render the card to an HTML element:
			var renderedCard = adaptiveCard.render();

			// And finally insert it in the page:
			document.getElementById('exampleDiv').innerHTML = '';
			document.getElementById('exampleDiv').appendChild(renderedCard);
		}
		function loadCard() {
			const card = document.getElementById('acpayload').value;
			renderCard(JSON.parse(card));
		}

		function loadCardInTextArea(num) {
			let cardPayload = "";
			if (num == 1) {
				cardPayload = cardText;
			} 
			if (num == 2) {
				cardPayload = cardDate;
			}
			if (num == 3) {
				cardPayload = cardTime;
			}
			if (num == 4) {
				cardPayload = cardChoiceSet;
			}
			const card = JSON.stringify(cardPayload, null, "\t");
			document.getElementById('acpayload').value = card;
		}

		function clickReadWrite() {
			renderCard(cardRW);
		}
	</script>

<script defer src="adaptivecards.js"></script>
<link id="css" rel="stylesheet" type="text/css" href="adaptivecards.css">
</head>

<body onload="renderCard()">
	<h2>Inline Edit Playground</h2>

	<div style="display: flex; flex-direction: row; align-items:stretch;">
		<div style="display: flex; flex-direction: row; align-items: flex-start;">
			<div style="display: flex; flex-direction: column; align-items:flex-start;">
				<button onclick="loadCardInTextArea(1)" class = "button">Load Card -Input Text</button>

				<button onclick="loadCardInTextArea(2)" class = "button">Load Card -Input Date</button>
				
				<button onclick="loadCardInTextArea(3)" class = "button">Load Card -Input Time</button>
				
				<button onclick="loadCardInTextArea(4)" class = "button">Load Card -Input ChoiceSet</button>
			</div>
			<div style="margin-left: 200px;">
				<textarea id="acpayload" style="height: 1000px;">
				</textarea>
			</div>
		</div>
		<div style="margin-left: 200px;">
			<button onclick="loadCard()"  class = "button">Render Card</button>
			<div id="exampleDiv"></div>
		</div>
	</div>

</body>

</html>
